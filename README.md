# Test_NET_11.03.25

Веб-сервис для поиска рекламных площадок по локациям с использованием FastAPI и структуры Trie.

## Оглавление

- [Установка](#установка)
- [Запуск](#запуск)
- [Использование API](#использование-api)
  - [Корневой маршрут](#корневой-маршрут)
  - [Загрузка данных](#загрузка-данных)
  - [Поиск площадок](#поиск-площадок)
- [Примечания](#примечания)
- [Исходное задание](#исходное-задание)

## Установка

1. **Клонируйте репозиторий:**
   ```bash
   git clone https://github.com/TStartio/Test_NET_11.03.25.git
   cd Test_NET_11.03.25
   ```

2. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

## Запуск

Запустите сервис командой:
```bash
python main.py
```

Сервис будет доступен по адресу [http://127.0.0.1:8000](http://127.0.0.1:8000).

**Примечание:** После запуска сервиса, для удобной работы с API и документацией перейдите по следующему адресу: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs).

## Использование API

### Корневой маршрут

- **Метод:** GET
- **URL:** `http://127.0.0.1:8000`
- **Ответ:** HTML-страница с приветствием и инструкциями. Пример:
  ```html
  <h1>Добро пожаловать в Моё тестовое задание!</h1>
  <p>Этот сервис помогает подобрать рекламные площадки для заданной локации, используя структуру Trie для быстрой обработки запросов.</p>
  <h2>Как использовать API:</h2>
  <ul>
    <li><strong>Документация:</strong> Для удобной работы с API перейдите по <a href="/docs">ссылке</a>.</li>
    <li><strong>Загрузка данных:</strong> Для загрузки данных используйте метод POST на <code>/upload</code> с файлом в следующем формате:</li>
  </ul>
  <pre>
  Яндекс.Директ:/ru
  Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
  Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
  Крутая реклама:/ru/svrd
  </pre>
  <ul>
    <li><strong>Поиск площадок:</strong> Для поиска рекламных площадок по локации используйте метод GET на <code>/search?location=<location></code></li>
  </ul>
  ```

### Загрузка данных

- **Метод:** POST
- **URL:** `http://127.0.0.1:8000/upload`
- **Тело запроса:** form-data с ключом `file` и файлом в следующем формате:
  ```
  Яндекс.Директ:/ru
  Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
  Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
  Крутая реклама:/ru/svrd
  ```

- **Ответ:**
  ```json
  {"message": "Данные успешно загружены"}
  ```

#### Пример файла для загрузки:

```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

- **Описание:** Этот файл должен быть отправлен на эндпоинт `/upload` через метод POST. В нём перечислены рекламные площадки и локации, где они действуют. Каждая строка содержит название площадки и соответствующие локации через двоеточие.

### Поиск площадок

- **Метод:** GET
- **URL:** `http://127.0.0.1:8000/search?location=<location>`
- **Ответ:** JSON-список площадок, например:
  ```json
  {
    "platforms": [
      "Яндекс.Директ",
      "Ревдинский рабочий",
      "Крутая реклама"
    ]
  }
  ```

- **Описание:** Этот запрос вернёт список рекламных площадок, действующих в заданной локации. Локация передаётся как параметр `location` в URL.

#### Пример запроса:
```
GET http://127.0.0.1:8000/search?location=/ru/svrd/revda
```

#### Пример ответа:
```json
{
  "platforms": [
    "Яндекс.Директ",
    "Ревдинский рабочий",
    "Крутая реклама"
  ]
}
```

## Примечания

- Данные хранятся в оперативной памяти в структуре Trie.
- Некорректные строки в файле игнорируются.
- Для тестирования используйте файл `platforms.txt`, включённый в репозиторий.

## Исходное задание

### Задача: Рекламные площадки

Рекламодатели часто хотят размещать рекламу в конкретном регионе (локации), например, в московской области или в городе Малые Васюки. Цель сервиса – помочь подобрать рекламные площадки для заданного региона.

#### Пример файла с данными:
```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

- **Описание:**
  - *Ревдинский рабочий* – рекламная площадка, действующая в локациях `/ru/svrd/revda` и `/ru/svrd/pervik`.
  - Локации считаются вложенными, если одна содержит другую как префикс (например, `/ru/svrd/ekb` вложена в `/ru/svrd`, а `/ru/svrd` — в `/ru`).
  - Чем меньше вложенность локации, тем более глобально действует рекламная площадка.

- **Примеры соответствия:**
  - Локация `/ru/msk`: подходят *Газета уральских москвичей* и *Яндекс.Директ*.
  - Локация `/ru/svrd`: подходят *Яндекс.Директ* и *Крутая реклама*.
  - Локация `/ru/svrd/revda`: подходят *Яндекс.Директ*, *Ревдинский рабочий* и *Крутая реклама*.
  - Локация `/ru`: подходит только *Яндекс.Директ*.

#### Что реализовано:
- Веб-сервис с двумя методами REST API:
  1. **Загрузка рекламных площадок** из файла (перезаписывает всю хранимую информацию).
  2. **Поиск списка рекламных площадок** по заданной локации.
- Данные хранятся исключительно в оперативной памяти (in-memory collection).
- Приоритет – высокая производительность поиска.
- Сервис корректно обрабатывает некорректные входные данные.
- Проект опубликован на GitHub с подробной инструкцией по запуску.
- Юнит-тесты (при наличии) приветствуются.